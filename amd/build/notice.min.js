define ("local_sitenotice/notice",["jquery","core/ajax","core/modal_factory","local_sitenotice/modal_notice"],function(a,b,c,d){var e={},f,g=[],h={},i=function(){for(var a in e){if(!g.includes(a)){g.push(a);return e[a]}}return!1},j=function(){var b=i();if(!1==b){return}if("undefined"==typeof f){c.create({type:d.TYPE,title:b.title,body:b.content,large:!0}).then(function(c){f=c;f.setNoticeId(b.id);f.setRequiredAcknowledgement(b.reqack);f.getModal().on("click",f.getCloseButtonID(),function(){k();f.hide()});f.getModal().on("click",f.getAcceptButtonID(),function(){l();f.hide()});f.getModal().on("click","a",function(){var b=a(this).attr("data-linkid");m(b)});f.getModal().on("click",f.getAckCheckboxID(),function(){var b=a(f.getAckCheckboxID()).is(":checked");a(f.getAcceptButtonID()).attr("disabled",!b);if(!b){f.turnonToolTip()}else{f.turnoffToolTip()}});f.show();f.getModal().focus()})}else{f.setTitle(b.title);f.setBody(b.content);f.setNoticeId(b.id);f.setRequiredAcknowledgement(b.reqack);f.show();f.getModal().focus()}},k=function(){var a=f.getNoticeId(),c=b.call([{methodname:"local_sitenotice_dismiss",args:{noticeid:a}}]);c[0].done(function(a){if(a.redirecturl){window.open(a.redirecturl,"_parent","")}else{j()}}).fail(function(a){this.console.log(a)})},l=function(){var a=f.getNoticeId(),c=b.call([{methodname:"local_sitenotice_acknowledge",args:{noticeid:a}}]);c[0].done(function(a){if(a.redirecturl){window.open(a.redirecturl,"_parent","")}else{j()}}).fail(function(a){this.console.log(a)})},m=function(a){var c=b.call([{methodname:"local_sitenotice_tracklink",args:{linkid:a}}]);c[0].done(function(a){if(a.redirecturl){window.open(a.redirecturl,"_parent","")}}).fail(function(a){this.console.log(a)})};h.init=function(){var c=b.call([{methodname:"local_sitenotice_getnotices",args:{}}]);c[0].done(function(b){e=JSON.parse(b.notices);a(document).ready(function(){j()})}).fail(function(a){this.console.log(a)})};return h});
//# sourceMappingURL=notice.min.js.map
